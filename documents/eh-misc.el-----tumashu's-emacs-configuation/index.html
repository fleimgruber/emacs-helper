<!DOCTYPE html>
<html lang="en-us">
  <head>
    <title>eh-misc.el --- Tumashu&#39;s emacs configuation - Emacs-helper</title>
    <meta charset="utf-8" />
    <meta name="author" content="Feng Shu" />
    <link rel="stylesheet" href="https://tumashu.github.io/emacs-helper/media/css/main.css" type="text/css">
  </head>
<body class="container">
    <div>
      <header class="masthead">
        <h1 class="masthead-title"><a href="https://tumashu.github.io/emacs-helper/">Emacs-helper</a> <span class="subtitle">(Tumashu 的 emacs 配置)</span></h1>
        <ul>
          <li><a href="https://tumashu.github.io/emacs-helper/documents/">Documents</a></li>
          <li><a href="https://tumashu.github.io/emacs-helper/tags/">Tags</a></li>
          <li><a href="https://tumashu.github.io/emacs-helper/about/">About</a></li>
          <li><a href="https://github.com/tumashu/emacs-helper">GitHub</a></li>
          <li><a href="https://tumashu.github.io/emacs-helper/rss.xml">RSS</a></li>
        </ul>
        <form method="get" id="searchform" action="http://www.google.com/search">
          <input type="text" class="field" name="q" id="s" placeholder="Search">
          <input type="hidden" name="as_sitesearch" value="tumashu.github.io/emacs-helper">
        </form>
      </header>
    </div>

<div class="content-and-footer">
<div>
<div class="post">
<h1 class="post-title">eh-misc.el --- Tumashu&#39;s emacs configuation</h1>
<div id="table-of-contents">
<h2>&#30446;&#24405;</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#orgfdd81ed">1. 简介</a></li>
<li><a href="#org6bb9b87">2. 代码</a>
<ul>
<li><a href="#org04d2459">2.1. eh-website</a></li>
<li><a href="#org16c404e">2.2. el2org</a></li>
<li><a href="#org232da31">2.3. EPG</a></li>
<li><a href="#org145a3f3">2.4. sdcv</a></li>
<li><a href="#org5eaef11">2.5. emms</a></li>
<li><a href="#orge75c83e">2.6. elisp setting</a></li>
<li><a href="#org0b6a58c">2.7. org-journal</a></li>
<li><a href="#org02c8ce8">2.8. ESS</a></li>
<li><a href="#orgbd6e794">2.9. aggressive-indent</a></li>
<li><a href="#orgbb065db">2.10. autopair</a></li>
<li><a href="#orgdcb5fb2">2.11. multi-term</a></li>
<li><a href="#org7910a6b">2.12. wdired and dired-ranger</a></li>
<li><a href="#orga81ec9a">2.13. ace-jump</a></li>
<li><a href="#org94f1ca7">2.14. switch-window</a></li>
<li><a href="#org77b6d6e">2.15. gitpatch</a></li>
<li><a href="#org0f6a555">2.16. ebdb</a></li>
<li><a href="#org31a3eb7">2.17. magit</a></li>
<li><a href="#org111f816">2.18. projectile</a></li>
<li><a href="#org79c248e">2.19. guix</a></li>
<li><a href="#orgee6f99d">2.20. undo-tree</a></li>
<li><a href="#org1f2b04d">2.21. emacs-calfw</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="outline-container-orgfdd81ed" class="outline-2">
<h2 id="orgfdd81ed"><span class="section-number-2">1</span> 简介</h2>
<div class="outline-text-2" id="text-1">
<p>
这个文件是tumashu个人专用的emacs配置文件，emacs中文用户可以参考。
</p>
</div>
</div>

<div id="outline-container-org6bb9b87" class="outline-2">
<h2 id="org6bb9b87"><span class="section-number-2">2</span> 代码</h2>
<div class="outline-text-2" id="text-2">
</div><div id="outline-container-org04d2459" class="outline-3">
<h3 id="org04d2459"><span class="section-number-3">2.1</span> eh-website</h3>
<div class="outline-text-3" id="text-2-1">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">org-webpage</span>
  <span style="color: #4c83ff;">:config</span>
  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">my website's owp config</span>
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">eh-website</span> <span style="color: #4c83ff;">:ensure</span> nil)
  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">org-webpage's owp config</span>
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">owp-devtools</span> <span style="color: #4c83ff;">:ensure</span> nil)
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">pyim</span>
    <span style="color: #4c83ff;">:ensure</span> nil
    <span style="color: #4c83ff;">:config</span>
    <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">pyim owp config</span>
    (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">pyim-devtools</span> <span style="color: #4c83ff;">:ensure</span> nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org16c404e" class="outline-3">
<h3 id="org16c404e"><span class="section-number-3">2.2</span> el2org</h3>
<div class="outline-text-3" id="text-2-2">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">el2org</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-org232da31" class="outline-3">
<h3 id="org232da31"><span class="section-number-3">2.3</span> EPG</h3>
<div class="outline-text-3" id="text-2-3">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">epg</span>
  <span style="color: #4c83ff;">:config</span>
  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">1. Put the below to your ~/.gnupg/gpg-agent.conf:</span>
  <span style="color: #8B8989; font-style: italic;">;;       </span><span style="color: #8B8989; font-style: italic;">allow-emacs-pinentry</span>
  <span style="color: #8B8989; font-style: italic;">;;       </span><span style="color: #8B8989; font-style: italic;">allow-loopback-pinentry</span>
  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">2. gpgconf --reload gpg-agent</span>
  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">3. (setq epa-pinentry-mode 'loopback)</span>
  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">4. (pinentry-start)</span>
  (<span style="color: #4c83ff;">setq</span> epa-pinentry-mode 'loopback))
</pre>
</div>
</div>
</div>

<div id="outline-container-org145a3f3" class="outline-3">
<h3 id="org145a3f3"><span class="section-number-3">2.4</span> sdcv</h3>
<div class="outline-text-3" id="text-2-4">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">chinese-yasdcv</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:if</span> (not (eq system-type 'windows-nt))
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-c d"</span> . yasdcv-translate-at-point)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org5eaef11" class="outline-3">
<h3 id="org5eaef11"><span class="section-number-3">2.5</span> emms</h3>
<div class="outline-text-3" id="text-2-5">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">eh-emms</span> <span style="color: #4c83ff;">:ensure</span> nil)
</pre>
</div>
</div>
</div>

<div id="outline-container-orge75c83e" class="outline-3">
<h3 id="orge75c83e"><span class="section-number-3">2.6</span> elisp setting</h3>
<div class="outline-text-3" id="text-2-6">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">lisp-mode</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">aggressive-indent</span>
    <span style="color: #4c83ff;">:config</span>
    (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-elisp-setup</span> ()
      <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">&#36319;&#36394;&#34892;&#23614;&#31354;&#26684;</span>
      (<span style="color: #4c83ff;">setq</span> show-trailing-whitespace t)
      <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">&#39640;&#20142;TAB</span>
      (<span style="color: #4c83ff;">setq</span> highlight-tabs t)
      <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">&#33258;&#21160;&#32553;&#36827;</span>
      (aggressive-indent-mode))
    (add-hook 'emacs-lisp-mode-hook
              #'eh-elisp-setup)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0b6a58c" class="outline-3">
<h3 id="org0b6a58c"><span class="section-number-3">2.7</span> org-journal</h3>
<div class="outline-text-3" id="text-2-7">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">org-journal</span>
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-c C-j"</span> . org-journal-new-entry))
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">setq</span> org-journal-dir <span style="color: #61CE3C;">"E:/doc/journal/"</span>)
  (<span style="color: #4c83ff;">setq</span> org-journal-file-format <span style="color: #61CE3C;">"%Y%m%d.org"</span>)
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">org</span>
    <span style="color: #4c83ff;">:ensure</span> nil
    <span style="color: #4c83ff;">:config</span>
    (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">org-agenda</span>
      <span style="color: #4c83ff;">:ensure</span> nil
      <span style="color: #4c83ff;">:config</span>
      (<span style="color: #4c83ff;">setq</span> org-agenda-files
            (<span style="color: #4c83ff;">if</span> (file-directory-p org-journal-dir)
                (append (directory-files org-journal-dir t <span style="color: #61CE3C;">".org$"</span>)
                        org-agenda-files)
              org-agenda-files)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org02c8ce8" class="outline-3">
<h3 id="org02c8ce8"><span class="section-number-3">2.8</span> ESS</h3>
<div class="outline-text-3" id="text-2-8">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">ess</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">setq</span> ess-eval-visibly-p nil)
  (<span style="color: #4c83ff;">setq</span> ess-ask-for-ess-directory nil)
  (<span style="color: #4c83ff;">setq</span> ess-smart-S-assign-key <span style="color: #61CE3C;">"@"</span>)

  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-ess-popup-ESS-buffer</span> (eob-p)
    (<span style="color: #4c83ff;">interactive</span> <span style="color: #61CE3C;">"P"</span>)
    (ess-force-buffer-current)
    (<span style="color: #4c83ff;">let</span> ((buffer (current-buffer)))
      (ess-switch-to-ESS eob-p)
      (ess-show-buffer buffer t)))

  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-ess-eval-paragraph</span> (vis)
    (<span style="color: #4c83ff;">interactive</span> <span style="color: #61CE3C;">"P"</span>)
    (ess-eval-paragraph-and-step vis)
    (eh-ess-popup-ESS-buffer t))

  <span style="color: #4c83ff;">:bind</span> (<span style="color: #4c83ff;">:map</span>
         ess-mode-map
         (<span style="color: #61CE3C;">"C-c C-c"</span> . eh-ess-eval-paragraph)))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbd6e794" class="outline-3">
<h3 id="orgbd6e794"><span class="section-number-3">2.9</span> aggressive-indent</h3>
<div class="outline-text-3" id="text-2-9">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">aggressive-indent</span>)
</pre>
</div>
</div>
</div>

<div id="outline-container-orgbb065db" class="outline-3">
<h3 id="orgbb065db"><span class="section-number-3">2.10</span> autopair</h3>
<div class="outline-text-3" id="text-2-10">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">autopair</span>
  <span style="color: #4c83ff;">:config</span>
  (autopair-global-mode 1))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgdcb5fb2" class="outline-3">
<h3 id="orgdcb5fb2"><span class="section-number-3">2.11</span> multi-term</h3>
<div class="outline-text-3" id="text-2-11">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">multi-term</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">setq</span> multi-term-program <span style="color: #61CE3C;">"/bin/bash"</span>)
  (<span style="color: #4c83ff;">setq</span> multi-term-buffer-name <span style="color: #61CE3C;">"term"</span>)
  (<span style="color: #4c83ff;">setq</span> term-scroll-show-maximum-output nil)
  (<span style="color: #4c83ff;">setq</span> term-scroll-to-bottom-on-output nil)
  (<span style="color: #4c83ff;">setq</span> multi-term-dedicated-select-after-open-p t)
  (<span style="color: #4c83ff;">setq</span> term-bind-key-alist
        (append '((<span style="color: #61CE3C;">"C-c C-x"</span> . eh-term-send-ctrl-x)
                  (<span style="color: #61CE3C;">"C-c C-h"</span> . eh-term-send-ctrl-h))
                term-bind-key-alist))

  (remove-hook 'term-mode-hook 'eh-term-setup)
  (remove-hook 'term-mode-hook 'multi-term-keystroke-setup)
  (remove-hook 'kill-buffer-hook 'multi-term-kill-buffer-hook)

  (add-hook 'term-mode-hook #'eh-term-setup)
  (add-hook 'term-mode-hook #'multi-term-keystroke-setup)
  (add-hook 'kill-buffer-hook #'multi-term-kill-buffer-hook)

  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-term-setup</span> ()
    (<span style="color: #4c83ff;">setq</span> truncate-lines t)
    (<span style="color: #4c83ff;">setq</span> term-buffer-maximum-size 0)
    (<span style="color: #4c83ff;">setq</span> show-trailing-whitespace nil)
    (multi-term-handle-close))

  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-term-send-ctrl-x</span> ()
    <span style="color: #FBDE2D;">"Send C-x in term mode."</span>
    (<span style="color: #4c83ff;">interactive</span>)
    (term-send-raw-string <span style="color: #61CE3C;">"\C-x"</span>))

  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-term-send-ctrl-z</span> ()
    <span style="color: #FBDE2D;">"Send C-z in term mode."</span>
    (<span style="color: #4c83ff;">interactive</span>)
    (term-send-raw-string <span style="color: #61CE3C;">"\C-z"</span>))

  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-term-send-ctrl-h</span> ()
    <span style="color: #FBDE2D;">"Send C-h in term mode."</span>
    (<span style="color: #4c83ff;">interactive</span>)
    (term-send-raw-string <span style="color: #61CE3C;">"\C-h"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org7910a6b" class="outline-3">
<h3 id="org7910a6b"><span class="section-number-3">2.12</span> wdired and dired-ranger</h3>
<div class="outline-text-3" id="text-2-12">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">dired</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">wdired</span> <span style="color: #4c83ff;">:ensure</span> nil)
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">dired-ranger</span> <span style="color: #4c83ff;">:ensure</span> nil))
</pre>
</div>
</div>
</div>

<div id="outline-container-orga81ec9a" class="outline-3">
<h3 id="orga81ec9a"><span class="section-number-3">2.13</span> ace-jump</h3>
<div class="outline-text-3" id="text-2-13">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">ace-jump-mode</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-j"</span> . ace-jump-mode)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org94f1ca7" class="outline-3">
<h3 id="org94f1ca7"><span class="section-number-3">2.14</span> switch-window</h3>
<div class="outline-text-3" id="text-2-14">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">switch-window</span>
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-x o"</span> . switch-window)
         (<span style="color: #61CE3C;">"C-x 1"</span> . switch-window-then-maximize)
         (<span style="color: #61CE3C;">"C-x 2"</span> . switch-window-then-split-below)
         (<span style="color: #61CE3C;">"C-x 3"</span> . switch-window-then-split-right)
         (<span style="color: #61CE3C;">"C-x 0"</span> . switch-window-then-delete))
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">setq</span> switch-window-increase 6)
  (<span style="color: #4c83ff;">setq</span> switch-window-shortcut-style 'qwerty)
  (<span style="color: #4c83ff;">setq</span> switch-window-input-style 'minibuffer))
</pre>
</div>
</div>
</div>

<div id="outline-container-org77b6d6e" class="outline-3">
<h3 id="org77b6d6e"><span class="section-number-3">2.15</span> gitpatch</h3>
<div class="outline-text-3" id="text-2-15">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">gitpatch</span>
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-c m"</span> . gitpatch-mail))
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">setq</span> gitpatch-mail-function 'gnus-msg-mail)
  (<span style="color: #4c83ff;">setq</span> gitpatch-mail-attach-patch-key <span style="color: #61CE3C;">"C-c i"</span>)
  (<span style="color: #4c83ff;">setq</span> gitpatch-mail-database
        '(<span style="color: #61CE3C;">"guix-patches@gnu.org"</span>
          <span style="color: #61CE3C;">"emms-help@gnu.org"</span>
          <span style="color: #61CE3C;">"emacs-orgmode@gnu.org"</span>
          <span style="color: #61CE3C;">"emacs-devel@gnu.org"</span>)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org0f6a555" class="outline-3">
<h3 id="org0f6a555"><span class="section-number-3">2.16</span> ebdb</h3>
<div class="outline-text-3" id="text-2-16">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">ebdb</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">require</span> '<span style="color: #96CBFE;">ebdb-mua</span>)
  (<span style="color: #4c83ff;">require</span> '<span style="color: #96CBFE;">ebdb-com</span>)
  (<span style="color: #4c83ff;">require</span> '<span style="color: #96CBFE;">ebdb-chn</span>)
  (<span style="color: #4c83ff;">require</span> '<span style="color: #96CBFE;">ebdb-vcard</span>)
  (<span style="color: #4c83ff;">require</span> '<span style="color: #96CBFE;">ebdb-complete</span>)
  (ebdb-complete-enable)

  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">pyim</span>
    <span style="color: #4c83ff;">:config</span>
    <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">(defun eh-ebdb-search-chinese (string)</span>
    <span style="color: #8B8989; font-style: italic;">;;   </span><span style="color: #8B8989; font-style: italic;">(if (functionp 'pyim-isearch-build-search-regexp)</span>
    <span style="color: #8B8989; font-style: italic;">;;       </span><span style="color: #8B8989; font-style: italic;">(pyim-isearch-build-search-regexp string)</span>
    <span style="color: #8B8989; font-style: italic;">;;     </span><span style="color: #8B8989; font-style: italic;">string))</span>

    <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">(setq ebdb-search-transform-functions</span>
    <span style="color: #8B8989; font-style: italic;">;;       </span><span style="color: #8B8989; font-style: italic;">'(eh-ebdb-search-chinese))</span>
    (<span style="color: #4c83ff;">cl-defmethod</span> <span style="color: #ff1493;">ebdb-field-search</span>
        <span style="color: #4c83ff;">:around</span> (field criterion)
        (<span style="color: #4c83ff;">or</span> (cl-call-next-method)
            (<span style="color: #4c83ff;">when</span> (stringp criterion)
              (<span style="color: #4c83ff;">let</span> ((str (ebdb-string field)))
                (cl-some
                 (<span style="color: #4c83ff;">lambda</span> (pinyin)
                   (string-match-p criterion pinyin))
                 (append (pyim-hanzi2pinyin str nil <span style="color: #61CE3C;">""</span> t)
                         (pyim-hanzi2pinyin str t <span style="color: #61CE3C;">""</span> t)))))))))
</pre>
</div>
</div>
</div>

<div id="outline-container-org31a3eb7" class="outline-3">
<h3 id="org31a3eb7"><span class="section-number-3">2.17</span> magit</h3>
<div class="outline-text-3" id="text-2-17">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">magit</span>
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-c g"</span> . magit-status)
         <span style="color: #4c83ff;">:map</span> magit-status-mode-map
         (<span style="color: #61CE3C;">"C-c f"</span> . magit-format-patch))
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">swiper</span>
    <span style="color: #4c83ff;">:config</span>
    (<span style="color: #4c83ff;">setq</span> magit-completing-read-function 'ivy-completing-read)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org111f816" class="outline-3">
<h3 id="org111f816"><span class="section-number-3">2.18</span> projectile</h3>
<div class="outline-text-3" id="text-2-18">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">projectile</span>
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-x F"</span> . projectile-find-file)
         (<span style="color: #61CE3C;">"C-S-s"</span> . projectile-grep))
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">swiper</span>
    <span style="color: #4c83ff;">:ensure</span> nil
    <span style="color: #4c83ff;">:config</span> (<span style="color: #4c83ff;">setq</span> projectile-completion-system 'ivy))
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">wgrep</span>
    <span style="color: #4c83ff;">:config</span>
    (projectile-global-mode 1)
    (<span style="color: #4c83ff;">setq</span> projectile-enable-caching nil)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org79c248e" class="outline-3">
<h3 id="org79c248e"><span class="section-number-3">2.19</span> guix</h3>
<div class="outline-text-3" id="text-2-19">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">guix</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">setq</span> guix-directory <span style="color: #61CE3C;">"~/project/guix"</span>)
  (<span style="color: #4c83ff;">setq</span> geiser-debug-jump-to-debug-p nil)
  (add-hook 'after-init-hook 'global-guix-prettify-mode)
  (add-hook 'scheme-mode-hook 'guix-devel-mode)
  (<span style="color: #4c83ff;">with-eval-after-load</span> 'geiser-guile
    <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">NOTE: "~/.config/guix/latest/" is invaild,</span>
    <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">use "~/.config/guix/latest" instead.</span>
    (add-to-list 'geiser-guile-load-path
                 (concat (file-name-directory (locate-library <span style="color: #61CE3C;">"geiser.el"</span>))
                         <span style="color: #61CE3C;">"scheme/guile"</span>))
    (add-to-list 'geiser-guile-load-path <span style="color: #61CE3C;">"~/.config/guix/latest"</span>))

  (<span style="color: #4c83ff;">defvar</span> <span style="color: #ff69b4;">guix-export-directory</span> <span style="color: #61CE3C;">"~/myguix/"</span>)

  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">guix-export-package</span> ()
    (<span style="color: #4c83ff;">interactive</span>)
    (<span style="color: #4c83ff;">let*</span> ((directory (file-name-as-directory guix-export-directory))
           (current-module (guix-guile-current-module))
           (define-public-string
             (<span style="color: #4c83ff;">save-excursion</span>
               (end-of-defun)
               (<span style="color: #4c83ff;">let</span> ((end (point)))
                 (beginning-of-defun)
                 (buffer-substring (point) end))))
           (package-name
            (<span style="color: #4c83ff;">progn</span> (string-match <span style="color: #61CE3C;">"</span><span style="color: #E9C062;">\\</span><span style="color: #ff0000;">(</span><span style="color: #61CE3C;">define-public +</span><span style="color: #E9C062;">\\</span><span style="color: #ff0000;">)</span><span style="color: #E9C062;">\\</span><span style="color: #ff0000;">(</span><span style="color: #61CE3C;">[a-z-]+</span><span style="color: #E9C062;">\\</span><span style="color: #ff0000;">)</span><span style="color: #61CE3C;">\n+"</span>
                                 define-public-string)
                   (match-string 2 define-public-string)))
           (define-module-string
             (replace-regexp-in-string
              <span style="color: #61CE3C;">" *(define-module.*\n"</span>
              (format (concat <span style="color: #61CE3C;">"(define-module (%s)\n"</span>
                              <span style="color: #61CE3C;">"  #:use-module %s\n"</span>)
                      package-name current-module)
              (<span style="color: #4c83ff;">save-excursion</span>
                (goto-char (point-min))
                (search-forward <span style="color: #61CE3C;">"(define-module"</span>)
                (end-of-defun)
                (<span style="color: #4c83ff;">let</span> ((end (point)))
                  (beginning-of-defun)
                  (buffer-substring (point) end)))))
           (command (format <span style="color: #61CE3C;">"guix package --load-path='%s' -i %s "</span>
                            directory package-name)))
      (<span style="color: #4c83ff;">unless</span> (file-directory-p directory)
        (make-directory directory t))
      (<span style="color: #4c83ff;">with-temp-buffer</span>
        (insert define-module-string)
        (insert <span style="color: #61CE3C;">"\n"</span>)
        (insert define-public-string)
        (write-file (concat directory package-name <span style="color: #61CE3C;">".scm"</span>))
        (kill-new command)
        (message command)))))
</pre>
</div>
</div>
</div>

<div id="outline-container-orgee6f99d" class="outline-3">
<h3 id="orgee6f99d"><span class="section-number-3">2.20</span> undo-tree</h3>
<div class="outline-text-3" id="text-2-20">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">undo-tree</span>
  <span style="color: #4c83ff;">:bind</span> ((<span style="color: #61CE3C;">"C-c /"</span> . undo-tree-visualize))
  <span style="color: #4c83ff;">:config</span>
  (global-undo-tree-mode)
  (add-hook 'undo-tree-visualizer-mode-hook
            #'eh-undo-tree-visualizer-settings)
  (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-undo-tree-visualizer-settings</span> ()
    (<span style="color: #4c83ff;">interactive</span>)
    (define-key undo-tree-visualizer-mode-map (kbd <span style="color: #61CE3C;">"C-c C-k"</span>) #'undo-tree-visualizer-quit)
    (define-key undo-tree-visualizer-mode-map (kbd <span style="color: #61CE3C;">"C-k"</span>) #'undo-tree-visualizer-quit)
    (define-key undo-tree-visualizer-mode-map (kbd <span style="color: #61CE3C;">"k"</span>) #'undo-tree-visualizer-quit)
    (define-key undo-tree-visualizer-mode-map (kbd <span style="color: #61CE3C;">"C-g"</span>) #'undo-tree-visualizer-abort)))
</pre>
</div>
</div>
</div>

<div id="outline-container-org1f2b04d" class="outline-3">
<h3 id="org1f2b04d"><span class="section-number-3">2.21</span> emacs-calfw</h3>
<div class="outline-text-3" id="text-2-21">
<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">holidays</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">defvar</span> <span style="color: #ff69b4;">eh-calendar-holidays</span> nil)
  (<span style="color: #4c83ff;">setq</span> eh-calendar-holidays
        '(<span style="color: #8B8989; font-style: italic;">;;</span><span style="color: #8B8989; font-style: italic;">&#20844;&#21382;&#33410;&#26085;</span>
          (holiday-fixed 1 1 <span style="color: #61CE3C;">"&#20803;&#26086;"</span>)
          (holiday-fixed 2 14 <span style="color: #61CE3C;">"&#24773;&#20154;&#33410;"</span>)
          (holiday-fixed 3 8 <span style="color: #61CE3C;">"&#22919;&#22899;&#33410;"</span>)
          (holiday-fixed 3 14 <span style="color: #61CE3C;">"&#30333;&#33394;&#24773;&#20154;&#33410;"</span>)
          (holiday-fixed 4 1 <span style="color: #61CE3C;">"&#24858;&#20154;&#33410;"</span>)
          (holiday-fixed 5 1 <span style="color: #61CE3C;">"&#21171;&#21160;&#33410;"</span>)
          (holiday-fixed 5 4 <span style="color: #61CE3C;">"&#38738;&#24180;&#33410;"</span>)
          (holiday-float 5 0 2 <span style="color: #61CE3C;">"&#27597;&#20146;&#33410;"</span>)
          (holiday-fixed 6 1 <span style="color: #61CE3C;">"&#20799;&#31461;&#33410;"</span>)
          (holiday-float 6 0 3 <span style="color: #61CE3C;">"&#29238;&#20146;&#33410;"</span>)
          (holiday-fixed 9 10 <span style="color: #61CE3C;">"&#25945;&#24072;&#33410;"</span>)
          (holiday-fixed 10 1 <span style="color: #61CE3C;">"&#22269;&#24198;&#33410;"</span>)
          (holiday-fixed 12 25 <span style="color: #61CE3C;">"&#22307;&#35806;&#33410;"</span>)
          <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">&#20892;&#21382;&#33410;&#26085;</span>
          (holiday-lunar 1 1 <span style="color: #61CE3C;">"&#26149;&#33410;"</span> 0)
          (holiday-lunar 1 2 <span style="color: #61CE3C;">"&#26149;&#33410;"</span> 0)
          (holiday-lunar 1 3 <span style="color: #61CE3C;">"&#26149;&#33410;"</span> 0)
          (holiday-lunar 1 15 <span style="color: #61CE3C;">"&#20803;&#23477;&#33410;"</span> 0)
          (holiday-solar-term <span style="color: #61CE3C;">"&#28165;&#26126;"</span> <span style="color: #61CE3C;">"&#28165;&#26126;&#33410;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#23567;&#23506;"</span> <span style="color: #61CE3C;">"&#23567;&#23506;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#22823;&#23506;"</span> <span style="color: #61CE3C;">"&#22823;&#23506;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#31435;&#26149;"</span> <span style="color: #61CE3C;">"&#31435;&#26149;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#38632;&#27700;"</span> <span style="color: #61CE3C;">"&#38632;&#27700;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#24778;&#34544;"</span> <span style="color: #61CE3C;">"&#24778;&#34544;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#26149;&#20998;"</span> <span style="color: #61CE3C;">"&#26149;&#20998;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#35895;&#38632;"</span> <span style="color: #61CE3C;">"&#35895;&#38632;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#31435;&#22799;"</span> <span style="color: #61CE3C;">"&#31435;&#22799;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#23567;&#28385;"</span> <span style="color: #61CE3C;">"&#23567;&#28385;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#33426;&#31181;"</span> <span style="color: #61CE3C;">"&#33426;&#31181;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#22799;&#33267;"</span> <span style="color: #61CE3C;">"&#22799;&#33267;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#23567;&#26257;"</span> <span style="color: #61CE3C;">"&#23567;&#26257;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#22823;&#26257;"</span> <span style="color: #61CE3C;">"&#22823;&#26257;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#31435;&#31179;"</span> <span style="color: #61CE3C;">"&#31435;&#31179;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#22788;&#26257;"</span> <span style="color: #61CE3C;">"&#22788;&#26257;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#30333;&#38706;"</span> <span style="color: #61CE3C;">"&#30333;&#38706;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#31179;&#20998;"</span> <span style="color: #61CE3C;">"&#31179;&#20998;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#23506;&#38706;"</span> <span style="color: #61CE3C;">"&#23506;&#38706;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#38684;&#38477;"</span> <span style="color: #61CE3C;">"&#38684;&#38477;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#31435;&#20908;"</span> <span style="color: #61CE3C;">"&#31435;&#20908;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#23567;&#38634;"</span> <span style="color: #61CE3C;">"&#23567;&#38634;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#22823;&#38634;"</span> <span style="color: #61CE3C;">"&#22823;&#38634;"</span>)
          (holiday-solar-term <span style="color: #61CE3C;">"&#20908;&#33267;"</span> <span style="color: #61CE3C;">"&#20908;&#33267;"</span>)
          (holiday-lunar 5 5 <span style="color: #61CE3C;">"&#31471;&#21320;&#33410;"</span> 0)
          (holiday-lunar 8 15 <span style="color: #61CE3C;">"&#20013;&#31179;&#33410;"</span> 0)
          (holiday-lunar 7 7 <span style="color: #61CE3C;">"&#19971;&#22805;&#24773;&#20154;&#33410;"</span> 0)
          (holiday-lunar 12 8 <span style="color: #61CE3C;">"&#33098;&#20843;&#33410;"</span> 0)
          (holiday-lunar 9 9 <span style="color: #61CE3C;">"&#37325;&#38451;&#33410;"</span> 0)
          (holiday-lunar 12 22 <span style="color: #61CE3C;">"&#20908;&#33267;"</span> 0)))
  (<span style="color: #4c83ff;">setq</span> calendar-holidays eh-calendar-holidays))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">calendar</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">setq</span> calendar-month-name-array
        [<span style="color: #61CE3C;">"&#19968;&#26376;"</span> <span style="color: #61CE3C;">"&#20108;&#26376;"</span> <span style="color: #61CE3C;">"&#19977;&#26376;"</span> <span style="color: #61CE3C;">"&#22235;&#26376;"</span> <span style="color: #61CE3C;">"&#20116;&#26376;"</span> <span style="color: #61CE3C;">"&#20845;&#26376;"</span>
         <span style="color: #61CE3C;">"&#19971;&#26376;"</span> <span style="color: #61CE3C;">"&#20843;&#26376;"</span> <span style="color: #61CE3C;">"&#20061;&#26376;"</span> <span style="color: #61CE3C;">"&#21313;&#26376;"</span> <span style="color: #61CE3C;">"&#21313;&#19968;&#26376;"</span> <span style="color: #61CE3C;">"&#21313;&#20108;&#26376;"</span>])
  (<span style="color: #4c83ff;">setq</span> calendar-day-name-array
        [<span style="color: #61CE3C;">"&#26143;&#26399;&#26085;"</span> <span style="color: #61CE3C;">"&#26143;&#26399;&#19968;"</span> <span style="color: #61CE3C;">"&#26143;&#26399;&#20108;"</span> <span style="color: #61CE3C;">"&#26143;&#26399;&#19977;"</span> <span style="color: #61CE3C;">"&#26143;&#26399;&#22235;"</span> <span style="color: #61CE3C;">"&#26143;&#26399;&#20116;"</span> <span style="color: #61CE3C;">"&#26143;&#26399;&#20845;"</span>])

  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">&#19968;&#21608;&#31532;&#19968;&#22825;&#65292;0&#34920;&#31034;&#26143;&#26399;&#22825;, 1&#34920;&#31034;&#26143;&#26399;&#19968;</span>
  (<span style="color: #4c83ff;">setq</span> calendar-week-start-day 0))
</pre>
</div>

<div class="org-src-container">
<pre class="src src-emacs-lisp">(<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">calfw</span>
  <span style="color: #4c83ff;">:ensure</span> nil
  <span style="color: #4c83ff;">:config</span>
  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">cal-china-x</span> <span style="color: #4c83ff;">:ensure</span> nil)

  (<span style="color: #4c83ff;">defvar</span> <span style="color: #ff69b4;">eh-calfw-org-file</span> nil)
  (<span style="color: #4c83ff;">setq</span> eh-calfw-org-file <span style="color: #61CE3C;">"~/org/calfw.org"</span>)

  <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">&#26085;&#21382;&#34920;&#26684;&#36793;&#26694;&#35774;&#32622;</span>
  (<span style="color: #4c83ff;">setq</span> cfw:fchar-junction ?+
        cfw:fchar-vertical-line ?|
        cfw:fchar-horizontal-line ?-
        cfw:fchar-left-junction ?+
        cfw:fchar-right-junction ?+
        cfw:fchar-top-junction ?+
        cfw:fchar-top-left-corner ?+
        cfw:fchar-top-right-corner ?+)

  (<span style="color: #4c83ff;">setq</span> cfw:gettext-alist
        '((<span style="color: #61CE3C;">"Today"</span> . <span style="color: #61CE3C;">"t:&#20170;&#22825;"</span>)
          (<span style="color: #61CE3C;">"Month"</span> . <span style="color: #61CE3C;">"M:&#19968;&#26376;"</span>)
          (<span style="color: #61CE3C;">"Week"</span> . <span style="color: #61CE3C;">"W:&#19968;&#21608;"</span>)
          (<span style="color: #61CE3C;">"Two Weeks"</span> . <span style="color: #61CE3C;">"T:&#20004;&#21608;"</span>)
          (<span style="color: #61CE3C;">"Day"</span> . <span style="color: #61CE3C;">"D:&#19968;&#22825;"</span>)))

  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">calfw-org</span>
    <span style="color: #4c83ff;">:ensure</span> nil
    <span style="color: #4c83ff;">:config</span>
    (<span style="color: #4c83ff;">defun</span> <span style="color: #ff1493;">eh-calendar</span> ()
      (<span style="color: #4c83ff;">interactive</span>)
      (cfw:open-calendar-buffer
       <span style="color: #4c83ff;">:view</span> 'two-weeks
       <span style="color: #4c83ff;">:contents-sources</span>
       (list
        <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">orgmode source</span>
        (cfw:org-create-source <span style="color: #61CE3C;">"Green"</span>)))))

  (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">org-agenda</span>
    <span style="color: #4c83ff;">:ensure</span> nil
    <span style="color: #4c83ff;">:config</span>
    (<span style="color: #4c83ff;">unless</span> (member eh-calfw-org-file org-agenda-files)
      (<span style="color: #4c83ff;">push</span> eh-calfw-org-file org-agenda-files))
    (<span style="color: #4c83ff;">use-package</span> <span style="color: #96CBFE;">org-capture</span>
      <span style="color: #4c83ff;">:ensure</span> nil
      <span style="color: #4c83ff;">:config</span>
      <span style="color: #8B8989; font-style: italic;">;; </span><span style="color: #8B8989; font-style: italic;">&#20026;calfw&#35774;&#32622;&#19968;&#20010;capture&#27169;&#26495;&#24182;&#28155;&#21152;&#21040;org-capture-templates</span>
      (<span style="color: #4c83ff;">setq</span> cfw:org-capture-template
            '(<span style="color: #61CE3C;">"calfw2org"</span> <span style="color: #61CE3C;">"calfw2org"</span> entry (file+headline eh-calfw-org-file <span style="color: #61CE3C;">"Schedule"</span>)
              <span style="color: #61CE3C;">"* %?\n %(cfw:org-capture-day)\n %a"</span>))
      (<span style="color: #4c83ff;">setq</span> org-capture-templates
            (append org-capture-templates (list cfw:org-capture-template))))))
</pre>
</div>
</div>
</div>
</div>

</div>
</div>
    <div>
      <div class="post-meta">
        <span title="post date" class="post-info">2017-07-30</span>
        <span title="last modification date" class="post-info">2017-07-30</span>
        <span title="tags" class="post-info">N/A</span>
        <span title="author" class="post-info">Feng Shu</span>
      </div>
      <div class="footer">
        <p>Generated by <a href="http://www.gnu.org/software/emacs/">Emacs</a> 25.x(<a href="http://orgmode.org">Org mode</a> 9.x)</p>
        <p>
          Copyright &copy; <span id="footerYear"></span> <a href="mailto:tumashu &lt;at&gt; 163 &lt;dot&gt; com">Feng Shu</a>
          &nbsp;&nbsp;-&nbsp;&nbsp;
          Powered by <a href="https://github.com/tumashu/org2web" target="_blank">org2web</a>
          <script type="text/javascript">document.getElementById("footerYear").innerHTML = (new Date()).getFullYear();</script>
        </p>
      </div>
    </div>

</div>
</body>
</html>
